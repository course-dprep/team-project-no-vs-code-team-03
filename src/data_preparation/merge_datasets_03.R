##################
##################
##MERGE DATASETS##
##################
##################

# --- Loading Libraries and Datasets --- #
library(dplyr)
library(readr)

title_basics_no_NAs <- read_csv("gen/temp/title_basics_no_NAs.csv")
title_episode_no_NAs <- read_csv("gen/temp/title_episode_no_NAs.csv")
title_ratings <- read_delim("gen/temp/title_ratings.tsv.gz", delim = "\t")

# --- Merging Datasets --- #
# Merging datasets based on tconst (common identifier)
merged_data <- title_basics_no_NAs %>%
  inner_join(title_ratings, by = "tconst") %>%
  inner_join(title_episode_no_NAs, by = c("tconst" = "parentTconst"))

# --- Save Data --- #
write.csv(merged_data, file = "gen/temp/merged_data.csv", row.names = FALSE)

